{% extends 'landing/base.html' %}
{% load crispy_forms_tags %}
{% load static %}
{% block content %}
<div class="container">
  <div class="row mt-5">
    <div class="col-md-5 col-sm-6">
      <a href="{{request.META.HTTP_REFERER}}" class="btn btn-light">Back To Feed</a>
    </div>
  </div>

  <div class="row justify-content-center mt-3">
    <div class="col-md-5 col-sm-12 border-bottom">
      <div>
        {% if request.user == post.author %}
          <a href="{% url 'post-edit' post.pk %}" style="color: #333;"><i class="far fa-edit"></i></a>
          <a href="{% url 'post-edit' post.pk %}" style="color: #333;"><i class="fas fa-trash"></i></a>
        {% endif %}

          <a href="{{post.author.profile.picture.url}}"><img src="{{post.author.profile.picture.url}}" class="rounded-circle post-img" height="30" width="30"></a>
        <p class="post-text">
          <a style="text-decoration: none;" class="text-primary" href="{% url 'profile' post.author.profile.pk %}">@{{post.author}}
          </a> {{post.created_on}}
        </p>
      </div>
      <div class="position-relative">
        <p>{{post.body}}</p>
      <a href="" class="stretched-link"></a>
      </div>

      <div class="d-flex flex-row">
        <form action="#" method="POST">
          {% csrf_token %}
          <input type="hidden" name="next" value="{{request.path}}">
          <button class="background-color:transparent; border:none; box-shadow:none;" style="background-color: transparent; border: none; box-shadow: none;" type="submit">
            <i class="far fa-thumbs-up"> <span>{{post.likes.all.count}}</span></i>
          </button>
        </form>

        <form action="#" method="POST">
          {% csrf_token %}
          <input type="hidden" name="next" value="{{request.path}}">
          <button class="background-color:transparent; border:none; box-shadow:none;" style="background-color: transparent; border: none; box-shadow: none;" type="submit">
            <i class="far fa-thumbs-down"> <span>{{post.dislikes.all.count}}</span></i>
          </button>
        </form>
      </div>
    </div>
  </div>

  <div class="row justify-content-center mt-3">
    <div class="col-md-3 col-sm-12">
      <form action="" method="POST">
        {% csrf_token %}
        {{form.as_p}}
        <div class="d-grid gap-2 mb-5">
          <button type="submit" class="btn btn-success mt-3">Submit</button>
        </div>
      </form>
    </div>
  </div>
  {% for comment in comments %}
  
    <div class="row justify-content-center mt-3 ">
      <div class="col-md-3 col-sm-12 border-bottom">
        <div>  
          <img src="#" class="rounded-circle post-img" height="30" width="30">
          <p class="post-text">
            <a style="text-decoration: none;" class="text-primary" href="#">@{{comment.author}}
            </a> {{comment.created_on|timesince}}
          </p>
        </div>
        {% if request.user == comment.author %}
          <a href="#" style="color: #333;"><i class="fas fa-trash"></i></a>
        {% endif %}
        <div class="position-relative">
          <p>{{comment}}</p>
        </div>
        <div class="d-flex flex-row">
          <form action="#" method="POST">
            {% csrf_token %}
            <button class="background-color:transparent; border:none; box-shadow:none;" style="background-color: transparent; border: none; box-shadow: none;" type="submit">
              <i class="far fa-thumbs-up"> <span></span></i>
            </button>
          </form>
  
          <form action="#" method="POST">
            {% csrf_token %}
            <button class="background-color:transparent; border:none; box-shadow:none;" style="background-color: transparent; border: none; box-shadow: none;" type="submit">
              <i class="far fa-thumbs-down"> <span></span></i>
            </button>
          </form>
          <div>
            <button style="background-color: transparent; border:none;" class="remove-default-btn"><i class="far fa-comment-dots" onclick="commentReplyToggle('{{ comment.pk }}')"></i></button>
          </div>
        </div>
      </div>
      </div>
    </div>  
    <div class="row justify-content-center mt-3 d-none">
      <div class="col-md-3 col-sm-12">
        <form action="#" method="POST">
          {% csrf_token %}
          {{form}}
          <div class="d-grid gap-2 mb-5">
            <button class="btn btn-success mt-3">Submit</button>
          </div>
        </form>
      </div>
    </div>

    {% endfor %}   
</div>

<script type="text/javascript" src="{% static 'js/social.js' %}"></script>
{% endblock content %}